
<h2>Проделанная работа</h2>

В этом проекте разработан сервис на базе `FAST API`, который будет обрабатывать `HTTP`-запросы к БД и возвращать топ N постов по количеству лайков.
Ппроделана работа с признаками, построена и обучена модель машинного обучения. Получился готовый сервис на `FAST API` по рекомендации постов пользователям.
Усовершенствованна модель, добавлением приемов, из `Deep Learning`. Сделан эмбеддинг для объектов с помощью предобученных моделей из `Hugging Face`. 
В этом проекте сделана их с помощью моделей `BERT` `(bert-base-cased, roberta-base, distilbert-base-cased)`, воспользовавшись функцией `get_embeddings_labels`

<h2>Возможные направления дальнейшей работы</h2>
В качестве возможных направлений для улучшения своей рекомендательной системы:

1. Дополнительные признаки от нейронных сетей, например, векторизовать тексты постов с помощью разных методов, рассмотренных в блоке, сделать какие-то новые признаки на основе этих векторов.
2. Применить нейронные сети в качестве модели рекомендаций.
3. Построить векторы пользователей.

<h2>Использованные технологии</h2>

* Языки программирования: `Python`
* Инструменты машинного обучения: `scikit-learn`, `PyTorch`, `XGBoost`, `LightGBM`, `CatBoost`
* Инструменты для визуализации данных: `Matplotlib`, `Seaborn`
* Инструменты для предобработки данных: `Pandas`, `NumPy`
* Базы данных и системы хранения данных: `SQL (PostgreSQL)`
* Статистические пакеты: `Stata`
* Итные инструменты: `sqlalchemy`, `requests`, `pydantic`, `psycopg2-binary`, `category-encoders`, `loguru`, `implicit`




<h2>Предыстория `Karpov Courses`</h2>

Мы построили социальную сеть для студентов `Karpov Courses`, которая обладает следующим функционалом: можно отправлять друг другу письма, создавать сообщества, аналогичные группам в известных сетях, и в этих сообществах публиковать посты.

Из приятного – при регистрации студенты должны заполнять данные по своему профилю, которые хранятся в поднятой на наших мощностях postgres database.

| Field name | Overview |
|----------|----------|
|user_id|Уникальный идентификатор пользователя|
|age| Возраст пользователя (в профиле)  |
|city|Город пользователя (в профиле)|
|country|Страна пользователя (в профиле)|
|exp_group|Экспериментальная группа: некоторая зашифрованная категория|
|gender|Пол пользователя|
|os|Операционная система устройства, с которого происходит пользование соц.сетью|
|source|Пришел ли пользователь в приложение с органического трафика или с рекламы|


Так же наша платформа обладает лентой, которую пользователи могут листать и просматривать случайные записи случайных сообществ. Если пост нравится, можно поддержать автора и поставить like.
Все действия пользователей сохраняются, каждая их активность, связанная с просмотром постов, тоже записывается к нам в базу.
|Field name	|Overview|
|----------|----------|
|timestamp|	Время, когда был произведен просмотр|
|user_id	|id пользователя, который совершил просмотр|
|post_id|	id просмотренного поста|
|action|	Тип действия: просмотр или лайк|
|target	|1 у просмотров, если почти сразу после просмотра былсовершен лайк, иначе 0. У действий like пропущенное значение.|

Так же имеется база с информацией о всех постах этой социальной сети. 
|Field name	|Overview|
|----------|----------|
|id	|Уникальный идентификатор поста|
|text	|Текстовое содержание поста|
|topic|	Основная тематика|


<h2>Оценка качества модели</h2>

Качество написанного вами алгоритма будет проверяться по метрике hitrate@5.
Если хотя бы один из 5 предложенных постов будет лайкнут - значение 1, если нет - 0. 

![image](https://github.com/babuhinalex/PetProjects/assets/116432702/be591f34-88ec-4551-8ba7-80f196b2c56f)


<h2>Требования к сервису</h2>

* Алгоритм должен работать не более чем за ~0.1 секунду на 1 запрос и занимать не более ~4 гб памяти. 
* Сервис будет импортировать уже обученную модель и применять ее.
* Набор юзеров фиксирован и никаких новых появляться не будет.


<h2>Требования к библиотекам</h2>

* pandas==1.4.2
* sqlalchemy==1.4.35
* requests==2.27.1
* catboost==1.0.6
* numpy==1.22.4
* pydantic==1.9.1
* scikit_learn==1.1.1
* psycopg2-binary==2.9.3
* category-encoders==2.5.0
* loguru==0.6.0
* implicit==0.5.2


<h2>Описание работы микросервиса</h2>

Файлы микросервиса: 
* [MicroServiceML](https://github.com/babuhinalex/PetProjects/blob/main/RecSys_karpov.courses/MicroServiceML.py)
* [MicroServiceAB_test](https://github.com/babuhinalex/PetProjects/blob/main/RecSys_karpov.courses/MicroServiceAB_test.py)
* [MicroServiceDL](https://github.com/babuhinalex/PetProjects/blob/main/RecSys_karpov.courses/MicroServiceDL.py)

Файлы запуска микросервисов: 
* [test_ML](https://github.com/babuhinalex/PetProjects/blob/main/RecSys_karpov.courses/test_ML.py)
* [test_A-B](https://github.com/babuhinalex/PetProjects/blob/main/RecSys_karpov.courses/test_A-B.py)
* [test_DL](https://github.com/babuhinalex/PetProjects/blob/main/RecSys_karpov.courses/test_DL.py)

Архитектура сервиса: 
- Поступает id конкретного пользователя (реализация в test_), после чего икросервис загружает данные с серверов Postgresql, производятся вычисления и микросервис возвращает n лучших рекоментаций, которые юзер еще не лайкал.
